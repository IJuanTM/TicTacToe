const field=document.querySelector("section.field"),cells=field.querySelectorAll("div.row > div.col"),reset=document.querySelector("div.reset"),restart=document.querySelector("div.restart"),oScore=document.querySelector("#o-score"),xScore=document.querySelector("#x-score"),message=document.querySelector("span.message"),cards=document.querySelectorAll("section.card"),hLine=document.querySelector("div.h-line"),vLine=document.querySelector("div.v-line"),dLineL=document.querySelector("div.d-line-l"),dLineR=document.querySelector("div.d-line-r"),winStates=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];let game=[],turn="o",oWins=0,xWins=0,start="o";cells.forEach((e=>e.addEventListener("click",(async()=>{""===e.innerHTML&&(await makeMove(e),await checkWin())}))));const makeMove=async e=>{"o"===turn?Omove(e):Xmove(e)},Omove=e=>{e.innerHTML='<div class="o"></div>',game[e.id]="o",field.classList.remove("o-turn"),turn="x",field.classList.add("x-turn"),message.innerHTML="Crosses turn"},Xmove=e=>{e.innerHTML='<div class="x"></div>',game[e.id]="x",field.classList.remove("x-turn"),turn="o",field.classList.add("o-turn"),message.innerHTML="Circles' turn"},checkWin=async()=>{winStates.every((e=>game[e[0]]&&game[e[0]]===game[e[1]]&&game[e[0]]===game[e[2]]?(field.style.pointerEvents="none","o"===game[e[0]]?Owins(e):Xwins(e),updateScores(),!1):(9===field.querySelectorAll("div.col > div").length&&(message.innerHTML="It's a draw!"),!0)))},Owins=e=>{oWins++,start="x",message.innerHTML="Circle wins!",0===e[0]&&1===e[1]&&2===e[2]?setLine("h",10.25,"#00f"):3===e[0]&&4===e[1]&&5===e[2]?setLine("h",33.5,"#00f"):6===e[0]&&7===e[1]&&8===e[2]?setLine("h",56.75,"#00f"):0===e[0]&&3===e[1]&&6===e[2]?setLine("v",10.25,"#00f"):1===e[0]&&4===e[1]&&7===e[2]?setLine("v",33.5,"#00f"):2===e[0]&&5===e[1]&&8===e[2]?setLine("v",56.75,"#00f"):0===e[0]&&4===e[1]&&8===e[2]?setLine("dl",null,"#00f"):2===e[0]&&4===e[1]&&6===e[2]&&setLine("dr",null,"#00f")},Xwins=e=>{xWins++,start="o",message.innerHTML="Cross wins!",0===e[0]&&1===e[1]&&2===e[2]?setLine("h",10.25,"#f00"):3===e[0]&&4===e[1]&&5===e[2]?setLine("h",33.5,"#f00"):6===e[0]&&7===e[1]&&8===e[2]?setLine("h",56.75,"#f00"):0===e[0]&&3===e[1]&&6===e[2]?setLine("v",10.25,"#f00"):1===e[0]&&4===e[1]&&7===e[2]?setLine("v",33.5,"#f00"):2===e[0]&&5===e[1]&&8===e[2]?setLine("v",56.75,"#f00"):0===e[0]&&4===e[1]&&8===e[2]?setLine("dl",null,"#f00"):2===e[0]&&4===e[1]&&6===e[2]&&setLine("dr",null,"#f00")},setLine=(e,s,t)=>{"h"===e?(hLine.style.top=s+"vmin",hLine.style.backgroundColor=t):"v"===e?(vLine.style.left=s+"vmin",vLine.style.backgroundColor=t):"dl"===e?dLineL.style.backgroundColor=t:"dr"===e&&(dLineR.style.backgroundColor=t)},clearLines=()=>{hLine.style.backgroundColor="transparent",vLine.style.backgroundColor="transparent",dLineL.style.backgroundColor="transparent",dLineR.style.backgroundColor="transparent"},updateScores=()=>{oScore.innerHTML=oWins.toString(),xScore.innerHTML=xWins.toString()},clearScores=()=>{oWins=0,xWins=0,updateScores()},startGame=()=>{updateScores(),restartGame()},Ostarts=()=>{turn="o",field.classList.remove("x-turn"),field.classList.add("o-turn"),message.innerHTML="Circle starts!"},Xstarts=()=>{turn="x",field.classList.remove("o-turn"),field.classList.add("x-turn"),message.innerHTML="Cross starts!"},restartGame=()=>{game=[],hLine.style.backgroundColor="transparent",vLine.style.backgroundColor="transparent",dLineL.style.backgroundColor="transparent",dLineR.style.backgroundColor="transparent",cells.forEach((e=>e.innerHTML="")),"o"===start?(turn="o",field.classList.remove("x-turn"),field.classList.add("o-turn"),message.innerHTML="Circle starts!"):(turn="x",field.classList.remove("o-turn"),field.classList.add("x-turn"),message.innerHTML="Cross starts!"),field.style.pointerEvents="auto"};reset.addEventListener("click",clearScores),restart.addEventListener("click",restartGame),window.addEventListener("load",startGame);